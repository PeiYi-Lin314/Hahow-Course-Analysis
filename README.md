# 用數據找先機 | 線上課程平台的潛力領域探索   

## 📌 專案介紹

本專案透過 `Python` 自動化爬取 Hahow 平台課程資訊，並完成資料清理與整合，產出結構化且可用於分析的 `CSV` 檔案。  

後續將利用 `Power BI` 及 `文字雲關鍵字分析`，探索潛力課程，找出市場中具有高潛力但尚未飽和的領域，作為課程開發與行銷策略的參考依據。  

目前程式仍在持續修正中，但已完成初步爬取與清理階段，並將文字雲與關鍵字分析結果展示於 Notion 作品集。
  
👉 [Hahow 官網](https://hahow.in/)    

👉 [用數據找先機｜本專案 Notion 連結](https://gold-twist-553.notion.site/1e047c95fe3580d88b1dff7b681ef583)  

⚠️ 本專案資料皆取自 Hahow 官網公開頁面，**僅供學術與個人學習用途，無商業意圖**。如有侵權疑慮，歡迎聯絡我以便下架處理。 

---
## 📌 專案結構
<pre>
hahow_course_analysis/  
├── README.md          # 專案說明文件  
├── scraped_data/      # 每頁課程的原始爬蟲資料（程式執行後自動產生）         
├── merged_data/       # 每個分類合併後的原始資料（程式執行後自動產生）                               
├── cleaned_data/      # 清理後的分類資料（程式執行後自動產生）  
├── total_data/        # 最終彙整的課程總表（程式執行後產出）
├── hahow_scraper.py   # 爬蟲主程式（爬取每一分類）  
├── merge_data.py      # 合併各分類 CSV 檔案  
└── clean_data.py      # 資料清理與整理合併檔案
</pre>
---
## 📌 環境設定  

### 🔧 必備軟體與套件版本
- Python 3.12.7
- Selenium 4.29.0（搭配 Chrome WebDriver）
- BeautifulSoup 4.12.3
- pandas 2.2.2
---

### 🌐 ChromeDriver 下載與設定    

本專案使用 Selenium 進行網頁自動化爬取，需搭配對應版本的 ChromeDriver。   

✅ 請依照您本機安裝的作業系統與 Chrome 版本下載對應的 ChromeDriver。到官方網站下載相應的驅動程式：
            
👉 [ChromeDriver 官方下載頁面](https://developer.chrome.com/docs/chromedriver/downloads?hl=zh-tw)

下載後，請將 ChromeDriver 可執行檔，放置在：
- 系統的 `PATH` 中
- 在程式碼中明確指定 ChromeDriver 的路徑
---
## 📌 程式特色  
- **Selenium + BeautifulSoup 自動化網頁爬取**
  
    - 結合 `Selenium`的瀏覽器模擬與 `BeautifulSoup` 的靜態網頁解析，提升資料抓取的穩定性與效率。搭配隨機 `User-Agent` 與 `Proxy` 設定，可降低被反爬蟲封鎖的風險，且易於擴充代理池。
    
- **靈活的正則表達式解析**
  
    - 針對未結構化且格式多變的課程資訊，設計專用正則表達式自動擷取重要欄位，大幅減少人工清理時間，並提升資料完整性。
      
- **嚴謹的錯誤處理與資料清理流程**
  
    - 包含缺失值檢查、格式轉換與數值標準化，確保輸出資料乾淨且一致，避免分析時因資料異常造成誤判。
      
- **高度擴充性設計**
  
    - 僅需新增 `course_type` 對應字典，即可快速加入更多課程分類，支援後續資料規模擴張與不同分類的靈活應用。
      
- **自動過濾異常資料**
  
    - 清理過程自動剔除缺少關鍵欄位或格式不符的資料列，保持資料品質穩定，為後續分析提供可靠基礎。
      
- **統一格式，方便分析工具直接使用**
  
    - 合併後資料欄位名稱與格式一致，方便無縫接軌 `Power BI`、`Tableau` 等商業智慧工具，快速建立互動式報表與視覺化分析。
---
## 📌 分析流程
- 圖片

---
## 📍 PART 1｜Hahow 課程資料擷取

本專案第一階段使用 `Selenium` 搭配 `BeautifulSoup`，自動擷取 Hahow 各分類課程資料。

- 每個分類的課程頁面會逐頁抓取課程資訊，包含課程名稱、課程連結、熱門標籤等欄位
- 擷取後的資料會自動儲存為 CSV 檔，存放於 `scraped_data/` 資料夾中
- CSV 檔案依據課程分類與頁碼命名，例如 `hahow音樂第一頁資料.csv`，方便後續資料整理與管理

此流程確保資料擷取自動化且系統化，為後續資料清理與分析打下穩固基礎。

### 🛠️ 執行說明

1. 安裝必要套件（請參見上方 **環境設定** 章節，手動安裝所需套件）
  
2. 執行主程式 `hahow_scraper.py`
  
3. 可於程式中依需求調整以下變數：
   - `course_type`：設定欲爬取的課程分類
   - `user_agent_list` / `proxy_list`：自訂並隨機使用 User-Agent 和 Proxy，模擬正常使用者行為以避免被封鎖（此功能尚未實作）

### ⚠️ 爬蟲注意事項

1. **網站資料為 JavaScript 動態渲染**，課程區塊的 class（如 `gtWJhG`）可能會變動。  
   - 若無法擷取課程資料，請開啟開發者工具（F12）檢查 HTML 結構，並更新 `hahow_scraper.py` 中對應的 class 名稱。

2. **若出現「網頁無法開啟」或「爬取速度變慢」的情況：**  
   - 可能是 Proxy 過期，請進行更新。  
   - Hahow 可能調整了網站結構，請檢查並修正爬蟲邏輯。

---
## 📍 PART 2｜各分類資料合併

本程式將自動讀取 `scraped_data/` 資料夾中、依據課程分類所儲存的所有分頁 CSV 檔案，並合併為單一資料集，輸出至 `merged_data/` 資料夾。

例如：若「音樂」類別共有兩頁，則會讀取  
- `hahow音樂第1頁資料.csv`  
- `hahow音樂第2頁資料.csv`  

合併後輸出為：  
- `hahow音樂資料.csv`  

此步驟有助於後續資料清理與分析。

### 🧩 合併注意事項

- 程式會自動為每筆資料加入「分類」欄位，便於後續分析。
- 檔案命名格式為 `hahow{分類名稱}資料.csv`，可支援自動化讀取與錯誤追蹤。
- 若某分類資料缺少頁數，合併程序會提早結束，便於根據檔名快速定位中斷或遺漏頁數的問題。
- 使用 `pandas.concat()` 進行合併，並設定 `ignore_index=True`，確保合併後的資料索引一致且整齊。
---
## 📍 PART 3｜清理資料

此階段會依序讀取 `merged_data/` 資料夾中各分類的 CSV 檔案（檔名格式為 `hahow{分類名稱}資料.csv`），並進行資料清理：

- 詳細正則表達式與拆解邏輯請參考程式碼註解。
- 「課程名稱」格式多變，正則表達式已涵蓋常見變化（如「限時優惠」、「by」、「$NT」前後空白等），以提高擷取準確度。
- 處理文字中的數字格式（含千分位符號、時間單位換算），並轉換為數值型態。
- 若某筆資料缺少關鍵欄位（如評分），該筆資料將被刪除，確保後續資料分析的完整性與準確性。
- 欄位名稱與順序已統一設計，方便後續直接匯入 Power BI 等分析工具。

清理完成後，各分類的資料會儲存於 `cleaned_data/` 資料夾中，檔名格式為 `hahow{分類名稱}.csv`。

### 🔍 最終清理後的輸出欄位

| 欄位名稱 | 說明                             |
|----------|----------------------------------|
| 分類     | 課程所屬分類（例如：音樂、語言等） |
| 熱門標籤 | 原始爬蟲資料中提供的課程標籤（熱門標籤／無標籤） |
| 課程     | 課程名稱                         |
| 講師     | 課程講師                         |
| 評分     | 課程評分（例如：4.8）            |
| 評價數   | 評分人數                         |
| 課程時長 | 課程時長（單位：小時）           |
| 購買人數 | 購買人數                         |
| 價錢     | 課程價格                         |
| link     | 完整課程網址                     |

---
## 📍 PART 4｜合併清理後資料

當所有分類資料清理完成後，系統會自動將 `cleaned_data/` 資料夾中，檔名格式為 `hahow{分類名稱}.csv` 的檔案合併成一份整體總表。

📌 補充說明  
- 合併後的總表檔名為 `hahow_課程總表.csv`  
- 儲存於資料夾：`total_data/`
---
## 🛠 未來可擴充方向
- 加入定期排程機制，自動更新課程資訊
- 擴充資料欄位（如：上架日期、開課狀態、募資狀態、導師回應數等），提升資料探討深度
- 整合 Power BI 等商業分析工具進行視覺化（目前已有 Power BI 相關作法，文字雲及關鍵字分析部分仍待測試 Jupyter Notebook 執行狀況）

---

## 🙋‍♂️ 聯絡方式

感謝閱讀本專案！
  
若您有任何建議、想交流的地方，或對其他作品感興趣，歡迎聯絡我：  

📧 Email：cing880314@gmail.com  
  
📂 Notion：[ 完整作品集整理 ](https://gold-twist-553.notion.site/1e047c95fe3580d3b28cd0573424d909)

---

## 📌 版本紀錄

- **v1.0 初版（2025-05-15）**

  - 完成基本功能：資料爬取、合併、清理與匯出。  
  - 建立專案架構與流程說明。  
  - 製作基本 README，包含環境設定與程式特色。




